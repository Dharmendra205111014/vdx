"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function e(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function n(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}function i(e,n){return!n||"object"!==t(n)&&"function"!=typeof n?o(e):n}function o(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function r(t){var e="function"==typeof Map?new Map:void 0;return(r=function(t){if(null===t||(n=t,-1===Function.toString.call(n).indexOf("[native code]")))return t;var n;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,i)}function i(){return s(t,arguments,a(this).constructor)}return i.prototype=Object.create(t.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),l(i,t)})(t)}function s(t,e,n){return(s=c()?Reflect.construct:function(t,e,n){var i=[null];i.push.apply(i,e);var o=new(Function.bind.apply(t,i));return n&&l(o,n.prototype),o}).apply(null,arguments)}function c(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function a(t){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var u={events:[],subscribe:function(t,e,n){u.events.filter((function(i){return i.event===t&&i.callback===e&&i.context===n})).length>0||u.events.push({event:t,callback:e,context:n})},publish:function(t,e){for(var n=arguments.length,i=new Array(n>2?n-2:0),o=2;o<n;o++)i[o-2]=arguments[o];var r=u.events.filter((function(n){return n.event!==t||!e||e.constructor.name===n.context.constructor.name}));r.forEach((function(t){t.callback.apply(t.context,[].concat(i))}))}},d=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&l(t,e)}(h,r(HTMLElement));var e,s,d=(e=h,s=c(),function(){var t,n=a(e);if(s){var o=a(this).constructor;t=Reflect.construct(n,arguments,o)}else t=n.apply(this,arguments);return i(this,t)});function h(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h);(t=d.call(this)).attachShadow({mode:"open"});return t.id="vdx_"+(new Date).getTime(),t.getVideo(),u.subscribe("custom_video_volume_changed",t.volumeUpdate,o(t)),u.subscribe("custom_video_pause_changed",t.pauseChange,o(t)),document.onfullscreenchange=function(t){!document.fullscreenElement&&t.target&&(t.target.controls.fullscreen.innerHTML='<span class="mdi mdi-fullscreen"></span>')}.bind(o(t)),t}return n(h,null,[{key:"observedAttributes",get:function(){return["title","type","muted","autoplay"]}}]),n(h,[{key:"getVideoElement",value:function(t){var e=t.src,n=t.muted;this.video=document.createElement("video"),this.video.setAttribute("src",e),this.video.setAttribute("muted",n),this.video.setAttribute("volume",1)}},{key:"getTitleElement",value:function(t){var e=t.title;this.videoTitle=document.createElement("h1"),this.videoTitle.innerHTML=e}},{key:"getControls",value:function(){this.controls={container:document.createElement("div"),mute:document.createElement("button"),play:document.createElement("button"),fullscreen:document.createElement("button")},this.controls.container.setAttribute("class","video-controls"),this.controls.mute.innerHTML='<span class="mdi mdi-volume-high"></span>',this.controls.mute.addEventListener("click",this.volumeChanged.bind(this)),this.controls.play.innerHTML='<span class="mdi mdi-play"></span>',this.controls.play.addEventListener("click",this.playChanged.bind(this)),this.controls.fullscreen.innerHTML='<span class="mdi mdi-fullscreen"></span>',this.controls.fullscreen.addEventListener("click",this.changeScreen.bind(this)),this.controls.container.appendChild(this.controls.play),this.controls.container.appendChild(this.controls.mute),this.controls.container.appendChild(this.controls.fullscreen)}},{key:"changeScreen",value:function(t){document.fullscreenElement?(this.controls.fullscreen.innerHTML='<span class="mdi mdi-fullscreen"></span>',document.exitFullscreen()):(this.controls.fullscreen.innerHTML='<span class="mdi mdi-fullscreen-exit"></span>',this.container.requestFullscreen())}},{key:"pauseChange",value:function(t){this.id!==t&&this.pause()}},{key:"playChanged",value:function(t){this.video.paused?this.play():this.pause()}},{key:"play",value:function(){this.video.play(),u.publish("custom_video_volume_changed",this,this.id),this.controls.play.innerHTML='<span class="mdi mdi-pause"></span>'}},{key:"pause",value:function(){this.video.pause(),this.controls.play.innerHTML='<span class="mdi mdi-play"></span>'}},{key:"volumeUpdate",value:function(t){void 0!==t&&(this.video.volume=t?0:1),this.video.volume?(this.controls.mute.innerHTML='<span class="mdi mdi-volume-mute"></span>',this.video.volume=0):(this.controls.mute.innerHTML='<span class="mdi mdi-volume-high"></span>',this.video.volume=1)}},{key:"volumeChanged",value:function(t){this.volumeUpdate(),u.publish("custom_video_volume_changed",this,this.video.volume)}},{key:"getCSS",value:function(){var t=document.createElement("style");return t.innerHTML="\n            :host {\n                --title-color: #FFF;\n                --ctrl-btn-bg: #161a1c;\n                --light-color: white;\n                --ctrl-btn-radius: 5px;\n                --ctrl-btn-margin: 0 10px 0 0;\n                --ctrl-btn-height: 18px;\n                --video-box-shadow-color: #00000054;\n                font-family: 'Roboto', sans-serif;\n            }\n            .video-container {\n                width: 400 px;\n                display: flex;\n                justify-content: center;\n                flex-direction: column;\n                position: relative;\n            }\n            .video-container h1 {\n                color: var(--title-color, 'gray');\n                margin: 5px 0;\n                font-size: 24px;\n                padding: 0;\n                position: absolute;\n                top: 5px;\n                left: 5px;\n                background: black;\n                width: 100%;\n                opacity: 0.5;\n            }\n            .video-controls {\n                position: relative;\n                left: 0;\n                bottom: 30px;\n                display: flex;\n                align-items: center;\n                justify-content: center;\n            }\n            .video-controls button {\n                background: var(--ctrl-btn-bg, 'gray');\n                height: var(--ctrl-btn-height, '30px');\n                margin: var(--ctrl-btn-margin, '10px');\n                border-radius: var(--ctrl-btn-radius, '5px');\n                border: 1px solid;\n                color: var(--light-color, white);\n                cursor: pointer;\n                opacity: 0.5;\n                outline: none;\n            }\n            .video-controls button:hover {\n                opacity: 1;\n            }\n            .video-container video {\n                width: inherit;\n                border: 5px solid white;\n                box-shadow: 5px 5px 5px var(--video-box-shadow-color, lightgray);\n            }\n        ",t}},{key:"getVideo",value:function(){var t=this.getAttribute("title"),e=this.getAttribute("src-url"),n=this.getAttribute("type")||"full",i=this.getAttribute("muted");this.container=document.createElement("div"),this.container.setAttribute("class","video-container ".concat(n)),this.getTitleElement({title:t}),this.container.appendChild(this.videoTitle),"mini"===n?(this.container.style.width="400px",this.getVideoElement({src:e,muted:i})):(this.container.style.width="1024px",this.getVideoElement({src:e,muted:i})),this.container.appendChild(this.video),this.getControls(),this.container.appendChild(this.controls.container),this.shadowRoot.appendChild(this.container),this.shadowRoot.appendChild(this.getCSS())}},{key:"addExternalCSS",value:function(){var t=document.createElement("link");t.setAttribute("href","https://cdnjs.cloudflare.com/ajax/libs/MaterialDesign-Webfont/5.2.45/css/materialdesignicons.css"),t.setAttribute("rel","stylesheet"),this.shadowRoot.appendChild(t)}},{key:"attributeChangedCallback",value:function(t,e,n){switch(t){case"muted":case"type":this.shadowRoot.innerHTML="",this.addExternalCSS(),this.getVideo();break;case"title":this.videoTitle.innerHTML=n}}},{key:"disconnectedCallback",value:function(){console.log("Disconnected the element")}}]),h}();customElements.define("vdx-player",d);
